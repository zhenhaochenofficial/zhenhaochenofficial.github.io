<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Zhenhao Chen | GPT2 in MindSpore modelzoo</title>
  <meta property="og:title" content="Zhenhao Chen | GPT2 in MindSpore modelzoo" />
  <meta property="og:image" content="https://zhenhaochenofficial.github.io/img/profile.jpeg" />
  <meta name="description" content="A test markdown file">
  <meta property="og:description" content="A test markdown file" />
  <meta name="author" content="Zhenhao Chen">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900&display=swap"></noscript>
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
      <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i&display=swap"></noscript>
  <link rel="preload" href="https://use.fontawesome.com/releases/v5.12.1/css/all.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.1/css/all.css"></noscript>
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css" integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin="anonymous" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css" integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin="anonymous"></noscript>
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css" integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin="anonymous" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css" integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin="anonymous"></noscript>
  
  <link rel="preload" href="https://zhenhaochenofficial.github.io/css/resume.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://zhenhaochenofficial.github.io/css/resume.css"></noscript>
  <link rel="preload" href="https://zhenhaochenofficial.github.io/css/tweaks.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://zhenhaochenofficial.github.io/css/tweaks.css"></noscript>
  <link rel="preload" href="https://zhenhaochenofficial.github.io/css/resume-override.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://zhenhaochenofficial.github.io/css/resume-override.css"></noscript>
  <meta name="generator" content="Hugo 0.97.3" />
  
   
  
</head>
<body id="page-top">
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
  <a class="navbar-brand js-scroll-trigger" href="#page-top">
    <span class="d-block d-lg-none">Zhenhao Chen</span>
    <span class="d-none d-lg-block">
      <img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="/img/profile.jpeg" alt="">
    </span>
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link js-scroll-trigger" href="/#about">About</a>
      </li>

      
      
      <li class="nav-item">
        <a class="nav-link js-scroll-trigger" href="/#education">Education</a>
      </li>
  

  
  
  <li class="nav-item">
    <a class="nav-link js-scroll-trigger" href="/#experience">Experience</a>
  </li>


  
  <li class="nav-item">
    <a class="nav-link js-scroll-trigger" href="/#Publications">Publications</a>
  </li>

            

      
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="/#skills">Skills</a>
          </li>
      
      
      
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="/#open">Open Source</a>
          </li>
      


    </ul>
  </div>
</nav>

  <div class="container-fluid p-0">
    
<nav aria-label="breadcrumb">
  <ol  class="breadcrumb">
    







<li class="breadcrumb-item">
  <a href="https://zhenhaochenofficial.github.io/">Home</a>
</li>


<li class="breadcrumb-item">
  <a href="https://zhenhaochenofficial.github.io/projects/">Projects</a>
</li>


<li class="breadcrumb-item">
  <a href="https://zhenhaochenofficial.github.io/projects/contributions/">Open Source Contributions</a>
</li>


<li class="breadcrumb-item active">
  <a href="https://zhenhaochenofficial.github.io/projects/contributions/test/">GPT2 in MindSpore modelzoo</a>
</li>

  </ol>
</nav>




<section class="resume-section p-3 p-lg-5 d-flex d-column">
  <div class="my-auto">
    <h2 class="mb-0"><span class="text-primary">GPT2 in MindSpore modelzoo</span></h2>
    <h2 id="declaration">Declaration</h2>
<p>This is an early version of Minsdpore GPT2. The final version will be merged to MindSpore&rsquo;s ModelZoo.</p>
<p>MindSpore GPT2 has been merged to master branch of MindSpore&rsquo;s official repo. <a href="https://gitee.com/mindspore/models/tree/master/research/nlp/gpt2">Link</a></p>
<p>The official link of MindSpore ModelZoo: <a href="https://gitee.com/mindspore/models">Link</a></p>
<p><del>You can find our unmerged official MindSpore ModelZoo commit here: <a href="https://gitee.com/mindspore/mindspore/tree/f5cb27b21e40292ebd0d7b8afbe32a02acd13ae1/model_zoo/research/nlp/gpt2">Link</a> <a href="https://gitee.com/ouyang_xx/mindspore/tree/master/model_zoo/research/nlp/gpt2">Full Repo</a></del></p>
<p><del>Once it is merged to master branch of MindSpore repository, the official link is here: <a href="https://gitee.com/mindspore/mindspore/tree/master/model_zoo/research/nlp/gpt2">Link</a></del></p>
<h2 id="in-brief">In Brief</h2>
<p>An implementation of GPT2 with MindSpore from scratch.<!-- raw HTML omitted -->OpenAI&rsquo;s original paper: A Radford, J Wu, R Child, D Luan, D Amodei, Ilya Sutskever &ldquo;Language Models are Unsupervised Multitask Learners&rdquo; <a href="https://github.com/mindspore-ai/mindspore/tree/master/model_zoo/official/nlp">Link</a></p>
<h2 id="download-a-mindspore-gpt2-pretrained-model">Download a Mindspore-GPT2 pretrained model</h2>
<p>The model is a &lsquo;.ckpt&rsquo; file and has 3 different sizes. You should use a mindspore function &rsquo;load_checkpoint&rsquo; to load the parameters  <!-- raw HTML omitted -->
Download link: <a href="https://pan.baidu.com/s/1WZ0rZ0qafkUvEOScoN21YQ">https://pan.baidu.com/s/1WZ0rZ0qafkUvEOScoN21YQ</a> <!-- raw HTML omitted -->
Download key: 1895 <!-- raw HTML omitted --></p>
<h2 id="generation-demo">Generation Demo</h2>
<h3 id="usage">usage</h3>
<h4 id="download-official-image-of-mindspore">Download official image of MindSpore</h4>
<p>Use docker to pull official MindSpore GPU image (tag: 1.0.1 is recommended for this repo)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker pull mindspore/mindspore-gpu:1.0.1
</span></span></code></pre></div><p>You can run a Nvidia-docker2 container and link this repo to the file system of the container.</p>
<h4 id="run-python-file">Run python file</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>python interactive_sampling.py
</span></span></code></pre></div><p><img src="https://github.com/viewsetting/MindSpore-GPT2/blob/master/img/generation_demo.JPG?raw=true" alt="generation_demo"></p>
<h2 id="summary-task">Summary Task</h2>
<p>Performance on CNN-Dailymail (version 3.0.0)</p>
<p><img src="https://github.com/viewsetting/MindSpore-GPT2/blob/master/img/summary.png?raw=true" alt="summary"></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h5 id="results-on-test-set">Results on Test set</h5>
<table>
<thead>
<tr>
<th style="text-align:center">Model</th>
<th style="text-align:center">Device</th>
<th style="text-align:center">Dataset Size</th>
<th style="text-align:center">Finetune Rouge</th>
<th style="text-align:center">OpenAI Rouge</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">small</td>
<td style="text-align:center">Ascend</td>
<td style="text-align:center">11490</td>
<td style="text-align:center">24.07</td>
<td style="text-align:center">16.8</td>
</tr>
<tr>
<td style="text-align:center">medium</td>
<td style="text-align:center">Ascend</td>
<td style="text-align:center">11490</td>
<td style="text-align:center">25.94</td>
<td style="text-align:center">20.6</td>
</tr>
<tr>
<td style="text-align:center">large</td>
<td style="text-align:center">Ascend</td>
<td style="text-align:center">11490</td>
<td style="text-align:center">26.81</td>
<td style="text-align:center">21.5</td>
</tr>
</tbody>
</table>
<h5 id="comparison-to-openais-gpt2-tensorflow">Comparison to OpenAI&rsquo;s GPT2 (TensorFlow)</h5>
<table>
<thead>
<tr>
<th style="text-align:center">Model</th>
<th style="text-align:center">Rouge-1</th>
<th style="text-align:center">Rouge-2</th>
<th style="text-align:center">Rouge-L</th>
<th style="text-align:center">Rouge-AVG</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">OpenAI GPT2 XLarge</td>
<td style="text-align:center">29.34</td>
<td style="text-align:center">8.27</td>
<td style="text-align:center">26.58</td>
<td style="text-align:center">21.40</td>
</tr>
<tr>
<td style="text-align:center">MindSpore GPT2 small</td>
<td style="text-align:center">30.51</td>
<td style="text-align:center">11.37</td>
<td style="text-align:center">30.32</td>
<td style="text-align:center">24.07</td>
</tr>
<tr>
<td style="text-align:center">MindSpore GPT2 medium</td>
<td style="text-align:center"><strong>32.84</strong></td>
<td style="text-align:center"><strong>12.82</strong></td>
<td style="text-align:center"><strong>32.14</strong></td>
<td style="text-align:center"><strong>25.94</strong></td>
</tr>
</tbody>
</table>

    <p>Project link: <a href="https://github.com/viewsetting/MindSpore-GPT2">https://github.com/viewsetting/MindSpore-GPT2</a></p>
    <ul class="tags">
    
      <li><a class="tag" href="/tags/python">Python</a></li>
    
</ul>

  </div>
</section>


    <span style="color: #999999; font-size: 60%;">Nifty <a href="https://codepen.io/wbeeftink/pen/dIaDH">tech tag lists</a> from <a class="pen-owner-link" href="https://codepen.io/wbeeftink">Wouter Beeftink</a> </span>
    
  </div>
  
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js" integrity="sha512-0QbL0ph8Tc8g5bLhfVzSqxe9GERORsKhIn1IrpxDAgUsbBGz/V7iSav2zzW325XGd1OMLdL4UiqRJj702IeqnQ==" crossorigin="anonymous"></script>
  
  <script async src="/js/resume.js"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=XX-123446-01"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'XX-123446-01');
  </script>
  

  
</body>
</html>
